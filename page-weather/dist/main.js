(()=>{"use strict";let e,t,n,o,r,a,c,d=document.querySelector(".first-day-temp"),u=document.querySelector(".second-day-temp"),l=document.querySelector(".third-day-temp"),i=document.querySelector(".temp-today"),s=document.querySelector(".btn-C"),m=document.querySelector(".btn-F"),p=localStorage.getItem("temp");function g(a,c,g="en"){let h={};h="en"==g?{feels:"FEELS LIKE",wind:"WIND",humidity:"HUMIDITY",latitude:"Latitude",longitude:"Longitude"}:{feels:"ОЩУЩАЕТСЯ",wind:"ВЕТЕР",humidity:"ВЛАЖНОСТЬ",latitude:"Широта",longitude:"Долгота"},function(a,c,g,h){let S=document.querySelector(".latitude"),q=document.querySelector(".longitude");p=localStorage.getItem("temp"),S.textContent=`${h.latitude}: ${parseInt(a[0])}°${a[0].toFixed(2).slice(-2)}'`,q.textContent=`${h.longitude}: ${parseInt(a[1])}°${a[1].toFixed(2).slice(-2)}'`,fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${a[0]}&lon=${a[1]}2&lang=${g}&appid=0757c33071fd341244e92530be5e2462`).then((e=>e.json())).then((n=>{if(function(e){let t=new Date;document.querySelector(".date-today").textContent=t.toLocaleString(e,{month:"long",day:"numeric",weekday:"long"}),setInterval((()=>{let t=new Date;document.querySelector(".time-today").textContent=t.toLocaleString(e,{hour12:!1,timezone:"UTC",hour:"numeric",minute:"numeric",second:"numeric"})}),100)}(g),"ru"==g){let e=document.querySelector(".btn-en");document.querySelector(".btn-languages").append(e),document.querySelector(".search__field").placeholder="Поиск города",document.querySelector(".btn-ru").classList.add("active"),document.querySelector(".btn-en").classList.remove("active"),document.querySelector(".wind-speed").textContent=`${h.wind}: ${n.wind.speed} м/с`,function(e){let t=e,n={method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Token 71a742922c5bad58329772e3c4f6c8a288cdb4e8"},body:JSON.stringify({query:t})};return fetch("https://suggestions.dadata.ru/suggestions/api/4_1/rs/findById/country",n)}(n.sys.country).then((e=>e.json())).then((e=>{document.querySelector(".name-country-city").textContent=`${n.name}, ${e.suggestions[0].value}`})).catch((e=>console.log("error",e)))}else{let e=document.querySelector(".btn-ru");document.querySelector(".btn-languages").append(e),document.querySelector(".search__field").placeholder="Search city",document.querySelector(".wind-speed").textContent=`${h.wind}: ${n.wind.speed} m/s`,document.querySelector(".btn-ru").classList.remove("active"),document.querySelector(".btn-en").classList.add("active"),document.querySelector(".name-country-city").textContent=`${n.name}, ${c}`}e=n.main.temp,t=n.main.feels_like,document.querySelector(".summary-weather").textContent=n.weather[0].description,document.querySelector(".humidity").textContent=`${h.humidity}: ${n.main.humidity}%`,"C"==p?(s.classList.add("active"),m.classList.remove("active"),i.textContent=`${Math.round(n.main.temp-273.15)}`,document.querySelector(".apparent-temperature").textContent=`${h.feels}: ${Math.round(n.main.feels_like-273.15)}°`):(s.classList.remove("active"),m.classList.add("active"),i.textContent=`${Math.round(1.8*n.main.temp-459)}`,document.querySelector(".apparent-temperature").textContent=`${h.feels}: ${Math.round(1.8*n.main.feels_like-459)}`),document.querySelector(".icon-weather").src=`http://openweathermap.org/img/wn/${n.weather[0].icon}@2x.png`})),function(e,t){fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${e[0]}&lon=${e[1]}2&appid=0757c33071fd341244e92530be5e2462`).then((e=>e.json())).then((e=>{n=e.list[6].main.temp,o=e.list[14].main.temp,r=e.list[22].main.temp,"C"==p?(d.textContent=`${Math.round(e.list[6].main.temp-273.15)}°`,u.textContent=`${Math.round(e.list[14].main.temp-273.15)}°`,l.textContent=`${Math.round(e.list[22].main.temp-273.15)}°`):(d.textContent=`${Math.round(1.8*e.list[6].main.temp-459)}°`,u.textContent=`${Math.round(1.8*e.list[14].main.temp-459)}°`,l.textContent=`${Math.round(1.8*e.list[22].main.temp-459)}°`),document.querySelector(".first-day-icon").src=`http://openweathermap.org/img/wn/${e.list[6].weather[0].icon}@2x.png`,document.querySelector(".second-day-icon").src=`http://openweathermap.org/img/wn/${e.list[14].weather[0].icon}@2x.png`,document.querySelector(".third-day-icon").src=`http://openweathermap.org/img/wn/${e.list[22].weather[0].icon}@2x.png`,document.querySelector(".name-first-day").textContent=y(+(e.list[6].dt+"000"),t),document.querySelector(".name-second-day").textContent=y(+(e.list[14].dt+"000"),t),document.querySelector(".name-three-day").textContent=y(+(e.list[22].dt+"000"),t)}))}(a,g),function(a){m.addEventListener("click",(()=>{localStorage.setItem("temp","F"),m.classList.add("active"),s.classList.remove("active"),d.textContent=`${Math.round(1.8*n-459)}°`,u.textContent=`${Math.round(1.8*o-459)}°`,l.textContent=`${Math.round(1.8*r-459)}°`,i.textContent=`${Math.round(1.8*e-459)}`,document.querySelector(".apparent-temperature").textContent=`${a.feels}: ${Math.round(1.8*t-459)}°`})),s.addEventListener("click",(()=>{localStorage.setItem("temp","C"),s.classList.add("active"),m.classList.remove("active"),d.textContent=`${Math.round(n-273.15)}°`,u.textContent=`${Math.round(o-273.15)}°`,l.textContent=`${Math.round(r-273.15)}°`,i.textContent=`${Math.round(e-273.15)}`,document.querySelector(".apparent-temperature").textContent=`${a.feels}: ${Math.round(t-273.15)}°`}))}(h)}(a,c,g,h)}function y(e,t){let n=new Date(e);return setTimeout((()=>document.querySelector(".page-load").style.display="none"),500),n.toLocaleString(t,{weekday:"long"})}null==p&&(p="C");let h=document.querySelector(".btn-languages");function S(e,t){a=e,c=t;let n=localStorage.getItem("lang");null==n&&(n="en"),g(e,t,n)}ymaps.ready((function(){let e,t=new ymaps.Map("map",{center:[53.902284,27.561831],zoom:5});function n(){ymaps.geocode(document.querySelector(".search__field").value,{results:1}).then((function(n){e=n.geoObjects.get(0).properties.getAll().description.split(",")[0];let o=n.geoObjects.get(0),r=o.geometry.getCoordinates(),a=o.properties.get("boundedBy");S(r,e),t.setBounds(a,{checkZoomRange:!0})}))}new ymaps.SuggestView("suggest"),ymaps.geolocation.get({provider:"auto",mapStateAutoApply:!0}).then((function(n){e=n.geoObjects.get(0).properties.getAll().description.split(",")[0],t.geoObjects.add(n.geoObjects),S(n.geoObjects.position,e)})),document.querySelector(".search__field").addEventListener("keypress",(e=>{"Enter"==e.code&&n()})),document.querySelector(".search__btn-search").addEventListener("click",n)})),document.querySelector(".btn-en").addEventListener("click",(()=>{let e=document.querySelector(".btn-ru");h.append(e),h.classList.toggle("btn-languages-active"),localStorage.setItem("lang","en"),g(a,c,"en")})),document.querySelector(".btn-ru").addEventListener("click",(()=>{let e=document.querySelector(".btn-en");h.append(e),h.classList.toggle("btn-languages-active"),localStorage.setItem("lang","ru"),g(a,c,"ru")}));let q=Math.round(79*Math.random()+1),$="https://api.pexels.com/v1/search?orientation=landscape&query=forest&per_page=80";function f(){document.querySelector(".background").classList.add("change-background"),fetch($,{method:"GET",headers:{Accept:"application/json",Authorization:"563492ad6f9170000100000115bb7f005be04317b29e41cd71a6e239"}}).then((e=>e.json())).then((e=>{document.querySelector(".background").src=`${e.photos[q].src.large}`,document.querySelector(".background").addEventListener("load",(()=>document.querySelector(".background").classList.remove("change-background"))),q<e.photos.length-1?q++:(q=0,$=e.next_page)})).catch((e=>console.log("error",e)))}f();let b=document.querySelector(".fa-refresh"),x=document.querySelector(".btn-sort");b.addEventListener("click",(e=>{b.classList.add("fa-update"),f()})),b.addEventListener("animationend",(e=>{b.classList.remove("fa-update")})),x.addEventListener("click",(e=>{document.querySelector(".btn-languages").classList.toggle("btn-languages-active")})),"en"==localStorage.getItem("lang")?document.querySelector(".intro").textContent="Getting data about your location":document.querySelector(".intro").textContent="Получение данных о вашем местоположении"})();